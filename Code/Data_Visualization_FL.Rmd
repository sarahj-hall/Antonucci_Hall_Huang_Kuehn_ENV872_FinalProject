---
title: "Data_Visualization_FL"
author: "Isabelle Kuehn"
date: "2025-12-10"
output: html_document
---

```{r setup, include=FALSE}
# From Intitial Data Exploration
library(here)
library(tidyverse)
library(viridis)
library(RColorBrewer)
library(colormap)

outage_group_2021 <- read.csv(here('Data/Raw/Outage_Dataset/eaglei_outages_2021_group.csv'),
                              stringsAsFactors = TRUE)
outage_merged_2021 <- read.csv(here('Data/Raw/Outage_Dataset/eaglei_outages_2021_merged.csv'),
                              stringsAsFactors = TRUE)
outage_events_2021_24hr <- read.csv(here('Data/Raw/Outage_Dataset/eaglei_outages_with_events_2021_24_hours_lag.csv'), stringsAsFactors = TRUE)

outage_group_2015 <- read.csv(here('Data/Raw/Outage_Dataset/eaglei_outages_2015_group.csv'), stringsAsFactors = TRUE)
outage_group_2016 <- read.csv(here('Data/Raw/Outage_Dataset/eaglei_outages_2016_group.csv'), stringsAsFactors = TRUE)
outage_group_2017 <- read.csv(here('Data/Raw/Outage_Dataset/eaglei_outages_2017_group.csv'), stringsAsFactors = TRUE)
outage_group_2018 <- read.csv(here('Data/Raw/Outage_Dataset/eaglei_outages_2018_group.csv'), stringsAsFactors = TRUE)
outage_group_2019 <- read.csv(here('Data/Raw/Outage_Dataset/eaglei_outages_2019_group.csv'), stringsAsFactors = TRUE)
outage_group_2020 <- read.csv(here('Data/Raw/Outage_Dataset/eaglei_outages_2020_group.csv'), stringsAsFactors = TRUE)
outage_group_2021 <- read.csv(here('Data/Raw/Outage_Dataset/eaglei_outages_2021_group.csv'), stringsAsFactors = TRUE)
outage_group_2022 <- read.csv(here('Data/Raw/Outage_Dataset/eaglei_outages_2022_group.csv'), stringsAsFactors = TRUE)
outage_group_2023 <- read.csv(here('Data/Raw/Outage_Dataset/eaglei_outages_2023_group.csv'), stringsAsFactors = TRUE)

#merge into one dataset
outage_group_all_years <- rbind(outage_group_2015, outage_group_2016,outage_group_2017, outage_group_2018, outage_group_2019, outage_group_2020, outage_group_2021, outage_group_2022, outage_group_2023)

#change columns to state abbrevations
outage_group_all_years$state <- state.abb[match(outage_group_all_years$state, state.name)]

#export to combined years dataset
write.csv(outage_group_all_years, row.names = FALSE, 
          file = "./Data/Processed/outage_group_all_years.csv")

#filter out for FL 
outage_group_FL <- outage_group_all_years %>% 
  filter(state == 'FL') 
```

```{r}
my_theme <- theme_classic + theme(axis.text.x = element_text(angle = 45))

summary(outage_events_2021_24hr)
summary(outage_group_2021)
summary(outage_merged_2021)

#boxplot for total yearly outages from 2015-2023
outage_group_all_years %>% 
  filter(month == 0) %>% 
  ggplot(aes(x = state,
      y = outage_count))+
  geom_boxplot()

outage_group_FL %>% 
  filter(month == 0) %>% 
  ggplot(aes(x = year,
      y = outage_count))+
  geom_point()+
  geom_line()

#plots for Florida, monthly 
outage_group_FL %>% 
  filter(month != 0) %>% 
  ggplot(
    mapping = aes(
      x=factor(
      month,
      levels=1:12,
      labels=month.abb),
      y = outage_count,
      color = year)
    ) +
 geom_point(size = 2, alpha = 0.7)+
 scale_color_viridis(
   option = "mako", 
   direction = -1)+
  labs(
    title = "Number of Power Outages in Florida by Month from 2015 to 2023",
    y = "Number of Outages",
    x = "Month",
    color = "Year",
  )
```

```{r}
# Data Wrangling

# Create data sets like the plots above that distinguish between yearly outages in FL and monthly averages in FL

yearly_outages_FL <- outage_group_FL %>%
  filter(month == 0)

monthly_outages_FL <- outage_group_FL %>%
  filter(month != 0)
```

```{r}
yearly_outages_FL_plot <- ggplot(yearly_outages_FL, aes(x = year, y = outage_count)) +
  geom_line() + 
  geom_point() +
  geom_smooth(method="lm", se = FALSE, color = "darkorchid4") +
  labs(title = "2015-2023 Yearly Outages for Florida",
       y="Outage Count",
       x="Year")

yearly_outages_FL_plot
```

```{r}
# Monthly Outages Across FL from 2015-2023 with Linear Regression
monthly_outages_FL <- monthly_outages_FL %>% 
  mutate(Date = my(paste(month,"-",year)))

monthly_outages_FL_plot <- ggplot(monthly_outages_FL, 
                                  aes(x=factor(month, levels = 1:12, labels = month.abb), 
                                      y=outage_count, color = factor(year))) + 
  geom_point(size = 2, alpha = 0.7) +
  scale_colour_viridis(option = "mako", direction = -1, discrete = TRUE) +
  labs(title = "2015-2023 Monthly Outages for Florida",
       y="Outage Count",
       x="Date",
       color = "Year")

monthly_outages_FL_plot